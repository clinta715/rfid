<!doctype html>
<html>
	<head>
		<title>Dairyland Labs</title>
	</head>
	
	<body>
		<h1>RFID</h1>
		<p></p>
		<hr>
		<button type="button" id="readrfid">read rfid</button>
		<button type="button" id="writerfid">write rfid</button>
		<p>SID
		<input maxlength="4" type="text" id="sid" name="sid">
		</p><p>PID
		<input maxlength="4" type="text" id="pid" name="pid">
		</p><p>BAR
		<input maxlength="12" type="text" id="bar" name="bar">
		</p>
		
		<script>
			window.addEventListener("message", function(event) {
				if (event.source != window)
					return;
			
				let pidvalue = document.getElementById("pid");
				let sidvalue = document.getElementById("sid");
				let barvalue = document.getElementById("bar");
		
				pidvalue.setAttribute("value", event.data.pid );
				sidvalue.setAttribute("value", event.data.sid );
				barvalue.setAttribute("value", event.data.bar );
			});		
		
			readbutton = document.getElementById("readrfid");
			readbutton.onclick = function(element) {
				var url = "http://localhost:8000";
	
				window.postMessage({sid: "0000", pid: "0000", bar: "000000000000", command: "read", rfidurl: url }, "*");
			}
			
			writebutton = document.getElementById("writerfid");
			writebutton.onclick = function(element) {
				var url = "http://localhost:8000";
		
				let pidvalue = document.getElementById("pid");
				let sidvalue = document.getElementById("sid");
				let barvalue = document.getElementById("bar");
		
				window.postMessage({sid: sidvalue.value, pid: pidvalue.value, bar: barvalue.value, command: "write", rfidurl: url }, "*");
			};			
		</script>
  </body>
</html>